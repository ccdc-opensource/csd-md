============================= test session starts ==============================
platform linux -- Python 3.9.23, pytest-8.4.1, pluggy-1.6.0
rootdir: /home/kepa/CSD-MD/tests
plugins: anyio-4.9.0
collected 3 items

test_installation.py F..                                                 [100%]

=================================== FAILURES ===================================
____________________ TestInstallation.test_functionalities _____________________

self = <test_installation.TestInstallation testMethod=test_functionalities>

    def test_functionalities(self):
    
        def contains_matching_text(file_path, search_text):
            with open(file_path, 'r', encoding='utf-8') as file:
                for line in file:
                    if search_text.lower() in line.lower():
                        return True
            return False
    
        missing2 = []
        for example in EXAMPLES:
            print(f" => Test example {example} {'':.<{30 -len(example) - 1}}",end='',flush=True)
            cwd = Path.cwd()
            parent = cwd.parent
            yaml_file = parent / "examples" / f"{example}.yaml"
            log_file = cwd / f"{example}.log"
            script = parent / "CSD-MD.py"
            with open(log_file, 'w') as log:
                subprocess.run(['python', script, '--md_params', yaml_file],
                               stdout=log, stderr=subprocess.STDOUT)
            # Wait until the log file exists
            while not os.path.exists(log_file):
                time.sleep(0.1)  # Check every 100ms
            normal_termination = contains_matching_text(log_file, "MD simulation has completed")
            if normal_termination:
                print(f" PASS",flush=True)
            else:
                missing2.append(example)
                print(f".. FAIL <=",flush=True)
>       assert not missing2, f"Failed tests: {', '.join(missing2)}"
E       AssertionError: Failed tests: asp-4ph9-ML
E       assert not ['asp-4ph9-ML']

test_installation.py:71: AssertionError
----------------------------- Captured stdout call -----------------------------
 => Test example asp-gas-MM ................... PASS
 => Test example asp-solution-MM .............. PASS
 => Test example asp-gas-MM-enhanced .......... PASS
 => Test example asp-gas-ML ................... PASS
 => Test example asp-solution-ML .............. PASS
 => Test example ibu-gas-ML ................... PASS
 => Test example ibu-solution-MM-enhanced ..... PASS
 => Test example 4ph9-protein-MM .............. PASS
 => Test example asp-4ph9-MM .................. PASS
 => Test example asp-4ph9-ML .................... FAIL <=
 => Test example ibu-4ph9-MM .................. PASS
=============================== warnings summary ===============================
test_installation.py::TestInstallation::test_required_packages
test_installation.py::TestInstallation::test_required_packages
  <frozen importlib._bootstrap>:228: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute

test_installation.py::TestInstallation::test_required_packages
test_installation.py::TestInstallation::test_required_packages
  <frozen importlib._bootstrap>:228: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute

test_installation.py::TestInstallation::test_required_packages
  <frozen importlib._bootstrap>:228: DeprecationWarning: builtin type swigvarlink has no __module__ attribute

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED test_installation.py::TestInstallation::test_functionalities - Asserti...
============= 1 failed, 2 passed, 5 warnings in 2245.35s (0:37:25) =============
